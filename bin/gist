#!/usr/bin/env sh

# gist < <file>
# gist <filename> < <file>
# <command> <...> | gist
# <command> <...> | gist <filename>

username="gummesson"
filename="$1"

if [ -z "$filename" ]; then
  filename="gist.txt"
fi

tmpfile="/tmp/gist.$$.tmp"
touch $tmpfile

if [ ! -t 0 ]; then
  cat > $tmpfile
fi

content=$(cat $tmpfile)

curl \
  --user "$username" \
  --data "{\"files\":{\"$filename\":{\"content\":\"$content\"}}}" \
  https://api.github.com/gists

rm $tmpfile
